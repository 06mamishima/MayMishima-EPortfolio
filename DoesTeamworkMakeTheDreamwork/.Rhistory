)
)
),
# Tab 2: Scatterplot
tabPanel(
title = "Scatterplot",
sidebarLayout(
sidebarPanel(
checkboxGroupInput(inputId = "sport_choice",
label = "Choose sport(s):",
choices = sport_choice_values,
selected = sport_choice_values),
selectizeInput(inputId = "id_name",
label = "Identify players(s) in the scatterplot:",
choices = name_choices,
selected = NULL,
multiple = TRUE)
),
mainPanel(plotOutput(outputId = "scatter"))
)
),
# Tab 3: Defensive Rating Table
tabPanel(
"Defensive Rating",
sidebarLayout(
sidebarPanel(
selectizeInput(inputId = "cmpy",
label = "Choose one or more sports:",
choices = sports_choices,
selected = sports_choices,
multiple = TRUE),
sliderInput("Number_of_Players", "Number of Players to Display:",
min = 1, max = 100, value = 10)
),
mainPanel(DT::dataTableOutput('ex1'))
)
),
# Tab 4: Offensive Rating Table
tabPanel(
"Offensive Rating",
sidebarLayout(
sidebarPanel(
selectizeInput(inputId = "cmpy",
label = "Choose one or more sports:",
choices = sports_choices,
selected = sports_choices,
multiple = TRUE),
sliderInput("Number_of_Players",
"Number of Players to Display:",
min = 1, max = 100, value = 10)
),
mainPanel(DT::dataTableOutput('ex2'))
)
),
# Tab 5: Overall Rating Table
tabPanel(
"Overall Rating",
sidebarLayout(
sidebarPanel(
selectizeInput(inputId = "cmpy",
label = "Choose one or more sports:",
choices = sports_choices,
selected = sports_choices,
multiple = TRUE),
sliderInput("Number_of_Players",
"Number of Players to Display:", min = 1,
max = 100, value = 10)
),
mainPanel(DT::dataTableOutput('ex3'))
)
),
#Tab 6: Information Tab
tabPanel(
"Information",
mainPanel(
h1("Information about our app"),
p("For our project we created a combined dataset that includes almost all
athletes that played in North America’s five biggest professional sports
leagues (the MLB, NFL, NBA, NHL, and MLS). Then, for each sport we chose
different sport-specific statistics to summarize a player’s offensive and
defensive contribution. We then standardized these values to compare the
offensive, defensive, and overall production of players across the five
different sports. We know that we won’t be able to fully represent each
athlete’s offensive and defensive skill since we are minimizing their
impact to just two or three statistics, but we were still able to gain
insights by using this more simplified approach. The following paragraphs
explain in more detail the statistics we chose for each sport."),
p("For the baseball defensive statistic, we used total zone fielding runs
average (Rtot). It is measured by the player’s ability to make a play
compared to the league average for their position. There are many aspects
that go into this metric such as the batted ball type (ground ball, line
drive, fly ball), game situations, range covered by the player, pitcher
and batter handedness, and park dimensions. All of these metrics are
calculated and combined into Rtot. A positive score would mean that a
player is better than the league average for saving runs/making plays and
visa versa."),
p("For the baseball offensive statistic, we used reference weight on base
average, which measures a player’s offensive contribution, weighted in
proportion to the outcome of the hit (ex. a double is more weighted than
single) and takes into account differences in run scoring over the years.
The average of these are taken to create the statistic."),
p("For the baseball overall statistic, we used wins above replacement. It
combines a player’s offensive, defensive, baserunning, and pitching
contributions and compares that total to a league average replacement
player at the same position. WAR of 0 shows that a player is league
average, but a positive WAR would indicate that the player contributes
more than the league average while a negative WAR would mean the opposite.
Pitchers are also included in this statistic."),
p("All three of these baseball statistics were standardized as z scores.
We subtracted the value of the player’s stat to the league average across
the 5 seasons and then divided that by the standard deviation of the
league distribution across the 5 seasons."),
p("In soccer, we used the Aerial Duels percentage to standardize the
soccer athletes’ defensive scores, and we used goals scored to standardize
their offensive output. The aerial duels percentage is calculated as the
ratio of successful aerial duels won to the total number of aerial duels
attempted. Both the defensive and offensive scores were standardized as
z scores. The overall score was then computed as the average of the two
variables: defensive and offensive scores."),
p("For hockey, the offensive metric used was points (which combines total
goals scored and total primary or secondary assists). The defensive
statistic used was plus/minus which is a player’s point differential of
their team while they are on the ice (i.e. their plus/minus decreases by
one if they are on the ice when the opposing team scores a goal and vice
versa). The overall statistic was calculated by taking the average of a
player’s standardized offensive and defensive scores. (The standardization
process was calculated the same way as the other sports.)"),
p("For football, the chosen offensive statistic was passing yards and the
chosen defensive statistic was sacks. Passing yards are measured as the
total distance a player gains from completing passes in yards, including
the distance the ball travels in the air and distance gained by the
receiver after the catch. Sacks are measured as the number of times a
defensive player tackles the opposing team’s quarterback before the
quarterback can make a pass. Note, given the structure of football wherein
players are only considered “offensive” or “defensive”, most players only
have either sacks or yards. We chose to just set null values to zero to
represent how a football player only has either offensive or defensive
production. A player’s overall score was calculated as the average of
their standardized values of sacks and yards."),
p("For basketball, the chosen offensive and defensive statistics were
offensive win shares (OWS) and defensive win shares (DWS), respectively.
(OWS and DWS were both included and already calculated in the dataset that
we wrangled.) These stats measure a player’s contribution to their teams
based on their offensive and defensive performance. OWS accounts for a
player’s total points, possessions, and team and compares the player to
the league average to estimate how many wins can be attributed to the
player’s offensive production. In essence the formula for OWS is a
player’s marginal offense divided by the marginal points per win. DWS is
equivalent metric for defense in that it accounts for a player’s total
rebounds, steals, and blocks with their defensive rating (which is points
allowed per 100 possessions). DWS is calculated as a player’s marginal
defense divided by their marginal points per win to estimate how many wins
can be attributed to the players’ defensive contribution. To calculate our
variable of overall score, we took the average of a player’s standardized
OWS and DWS."),
h2("Data Sources"),
p("- MLS Soccer. (Last Updated 2025, May 14)
Stats: 2025. Major League Soccer LLC. Retrieved 2025, October 26.
https://www.mlssoccer.com/stats/players/#season=MLS-SEA-0001K9&competition=mls-regular-season&club=all&statType=general&position=all."),
p("- MLS Soccer. (Last Updated 2025, May 14)
Stats: 2024. Major League Soccer LLC. Retrieved 2025, October 26.
https://www.mlssoccer.com/stats/players/#season=2024&competition=mls-regular-season&club=all&statType=general&position=all."),
p("- MLS Soccer. (Last Updated 2025, May 14)
Stats: 2023. Major League Soccer LLC. Retrieved 2025, October 26.
https://www.mlssoccer.com/stats/players/#season=2023&competition=mls-regular-season&club=all&statType=general&position=all."),
p("- MLS Soccer. (Last Updated 2025, May 14)
Stats: 2022. Major League Soccer LLC. Retrieved 2025, October 26.
https://www.mlssoccer.com/stats/players/#season=2022&competition=mls-regular-season&club=all&statType=general&position=all."),
p("- MLS Soccer. (Last Updated 2025, May 14)
Stats: 2021. Major League Soccer LLC. Retrieved 2025, October 26.
https://www.mlssoccer.com/stats/players/#season=2021&competition=mls-regular-season&club=all&statType=general&position=all."),
p("- Basketball-Reference (Last updated 2025, November 2)
2024-25 NBA Player Stats: Advanced. Sports Reference LLC.
Retrieved on October 27,
https://www.basketball-reference.com/leagues/NBA_2025_advanced.html."),
p("- Basketball-Reference (Last updated 2025, November 2)
2023-24 NBA Player Stats: Advanced. Sports Reference LLC.
Retrieved on October 27,
https://www.basketball-reference.com/leagues/NBA_2024_advanced.html."),
p("- Basketball-Reference (Last updated 2025, November 2)
2022-23 NBA Player Stats: Advanced. Sports Reference LLC.
Retrieved on October 27,
https://www.basketball-reference.com/leagues/NBA_2023_advanced.html."),
p("- Basketball-Reference (Last updated 2025, November 2)
2021-22 NBA Player Stats: Advanced. Sports Reference LLC.
Retrieved on October 27,
https://www.basketball-reference.com/leagues/NBA_2022_advanced.html."),
p("- Basketball-Reference (Last updated 2025, November 2)
2020-21 NBA Player Stats: Advanced. Sports Reference LLC.
Retrieved on October 27,
https://www.basketball-reference.com/leagues/NBA_2021_advanced.html."),
p("- Pro-Football-Reference (Last updated 2025, November 2)
2024 NFL Passing. Sports Reference LLC. Retrieved on October 27,
https://www.pro-football-reference.com/years/2024/passing.htm."),
p("- Pro-Football-Reference (Last updated 2025, November 2)
2023 NFL Passing. Sports Reference LLC. Retrieved on October 27,
https://www.pro-football-reference.com/years/2023/passing.htm."),
p("- Pro-Football-Reference (Last updated 2025, November 2)
2022 NFL Passing. Sports Reference LLC. Retrieved on October 27,
https://www.pro-football-reference.com/years/2022/passing.htm."),
p("- Pro-Football-Reference (Last updated 2025, November 2)
2021 NFL Passing. Sports Reference LLC. Retrieved on October 27,
https://www.pro-football-reference.com/years/2021/passing.htm."),
p("- Pro-Football-Reference (Last updated 2025, November 2)
2020 NFL Passing. Sports Reference LLC. Retrieved on October 27,
https://www.pro-football-reference.com/years/2020/passing.htm."),
p("- Pro-Football-Reference (Last updated 2025, November 2)
2024 NFL Defense. Sports Reference LLC. Retrieved on October 27,
https://www.pro-football-reference.com/years/2024/defense.htm."),
p("- Pro-Football-Reference (Last updated 2025, November 2)
2023 NFL Defense. Sports Reference LLC. Retrieved on October 27,
https://www.pro-football-reference.com/years/2023/defense.htm."),
p("- Pro-Football-Reference (Last updated 2025, November 2)
2022 NFL Defense. Sports Reference LLC. Retrieved on October 27,
https://www.pro-football-reference.com/years/2022/defense.htm."),
p("- Pro-Football-Reference (Last updated 2025, November 2)
2021 NFL Defense. Sports Reference LLC. Retrieved on October 27,
https://www.pro-football-reference.com/years/2021/defense.htm."),
p("- Pro-Football-Reference (Last updated 2025, November 2)
2020 NFL Defense. Sports Reference LLC. Retrieved on October 27,
https://www.pro-football-reference.com/years/2020/defense.htm."),
p("- Hockey-Reference (Last updated 2025, November 2)
2024-25 NHL Skater Statistics. Sports Reference LLC.
Retrieved on October 26,
https://www.hockey-reference.com/leagues/NHL_2025_skaters.html."),
p("- Hockey-Reference (Last updated 2025, November 2)
2023-24 NHL Skater Statistics. Sports Reference LLC.
Retrieved on October 26,
https://www.hockey-reference.com/leagues/NHL_2024_skaters.html."),
p("- Hockey-Reference (Last updated 2025, November 2)
2022-23 NHL Skater Statistics. Sports Reference LLC.
Retrieved on October 26,
https://www.hockey-reference.com/leagues/NHL_2023_skaters.html"),
p("- Hockey-Reference (Last updated 2025, November 2)
2021-22 NHL Skater Statistics. Sports Reference LLC.
Retrieved on October 26,
https://www.hockey-reference.com/leagues/NHL_2022_skaters.html."),
p("- Hockey-Reference (Last updated 2025, November 2)
2020-21 NHL Skater Statistics. Sports Reference LLC.
Retrieved on October 26,
https://www.hockey-reference.com/leagues/NHL_2021_skaters.htm."),
p("- Baseball-Reference (Last updated 2025, November 2)
2025 Major League Baseball Standard Pitching: Player Standard Pitching.
Sports Reference LLC. Retrieved on October 26,
https://www.baseball-reference.com/leagues/majors/2025-standard-pitching.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2024 Major League Baseball Standard Pitching: Player Standard Pitching.
Sports Reference LLC. Retrieved on October 26,
https://www.baseball-reference.com/leagues/majors/2024-standard-pitching.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2023 Major League Baseball Standard Pitching: Player Standard Pitching.
Sports Reference LLC. Retrieved on October 26,
https://www.baseball-reference.com/leagues/majors/2023-standard-pitching.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2022 Major League Baseball Standard Pitching: Player Standard Pitching.
Sports Reference LLC. Retrieved on October 26,
https://www.baseball-reference.com/leagues/majors/2022-standard-pitching.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2021 Major League Baseball Standard Pitching: Player Standard Pitching.
Sports Reference LLC. Retrieved on October 26,
https://www.baseball-reference.com/leagues/majors/2021-standard-pitching.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2025 Major League Baseball Standard Fielding: Player Standard Fielding.
Sports Reference LLC. Retrieved on October 26,
https://www.baseball-reference.com/leagues/majors/2025-standard-fielding.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2024 Major League Baseball Standard Fielding: Player Standard Fielding.
Sports Reference LLC. Retrieved on October 26,
https://www.baseball-reference.com/leagues/majors/2024-standard-fielding.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2023 Major League Baseball Standard Fielding: Player Standard Fielding.
Sports Reference LLC. Retrieved on October 26,
https://www.baseball-reference.com/leagues/majors/2023-standard-fielding.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2022 Major League Baseball Standard Fielding: Player Standard Fielding.
Sports Reference LLC. Retrieved on October 26,
https://www.baseball-reference.com/leagues/majors/2022-standard-fielding.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2021 Major League Baseball Standard Fielding: Player Standard Fielding.
Sports Reference LLC. Retrieved on October 26,
https://www.baseball-reference.com/leagues/majors/2021-standard-fielding.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2025 Major League Baseball Standard Batting: Player Standard Batting.
Sports Reference LLC. Retrieved on October 24,
https://www.baseball-reference.com/leagues/majors/2025-standard-batting.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2024 Major League Baseball Standard Batting: Player Standard Batting.
Sports Reference LLC. Retrieved on October 24,
https://www.baseball-reference.com/leagues/majors/2024-standard-batting.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2023 Major League Baseball Standard Batting: Player Standard Batting.
Sports Reference LLC. Retrieved on October 24,
https://www.baseball-reference.com/leagues/majors/2023-standard-batting.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2022 Major League Baseball Standard Batting: Player Standard Batting.
Sports Reference LLC. Retrieved on October 24,
https://www.baseball-reference.com/leagues/majors/2022-standard-batting.shtml."),
p("- Baseball-Reference (Last updated 2025, November 2)
2021 Major League Baseball Standard Batting: Player Standard Batting.
Sports Reference LLC. Retrieved on October 24,
https://www.baseball-reference.com/leagues/majors/2021-standard-batting.shtml.")
)
)
)
shiny::runApp('Documents/GitHub/stat231maymishima/final_project/MLBSocialNetworks')
# Import data
networks <- readRDS("networks.rds")
setwd("~/Documents/GitHub/stat231maymishima/final_project/data_files")
runApp('~/Documents/GitHub/stat231maymishima/final_project/MLBSocialNetworks')
list.files
runApp('~/Documents/GitHub/stat231maymishima/final_project')
runApp('~/Documents/GitHub/stat231maymishima/final_project')
runApp()
setwd("/Users/maymishim/Documents/GitHub/stat231maymishima/final_project/data_files")
source("app.R")
setwd("/Users/maymishim/Documents/GitHub/stat231maymishima/final_project/data_files")
source("app.R")
setwd("/Users/maymishim/Documents/GitHub/stat231maymishima/final_project/data_files")
source("app.R")
runApp()
runApp()
runApp()
runApp('~/Documents/GitHub/stat231maymishima/final_project')
setwd("~/Documents/GitHub/stat231maymishima/final_project/data_files")
runApp('~/Documents/GitHub/stat231maymishima/final_project')
setwd("~/Documents/GitHub/stat231maymishima/final_project")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
transitivity |>
mutate(
Transitivity = round(Transitivity, 3),
AvgWinPct = round(AvgWinPct, 3)) |>
arrange(desc(Transitivity))
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
str(transitivit)
str(transitivity)
transitivity <- readRDS("transitivity.rds") |>
mutate(
Transitivity = as.numeric(Transitivity),
AvgWinPct = as.numeric(AvgWinPct)
)
transitivity <- readRDS("transitivity.rds") |>
mutate(
Transitivity = as.numeric(Transitivity)
)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
read_rds(slr_data.rds)
read_rds(transitivity.rds)
setwd("~/Documents/GitHub/stat231maymishima/final_project")
read_rds(transitivity.rds)
read_rds(transitivity.rds)
read_rds(transitivity.rds)
read_rds(transitivity.rds)
read_rds(transitivity.rds)
read_rds(transitivity.rds)
read_rds(transitivity.rds)
#| include: false #this is the only chunk you can "hide" in any way
library(kableExtra)
library(tidyverse)
library(purrr)
library(dplyr)
library(stringr)
library(readr)
library(readr)
library(mosaic)
library(GGally)
library(gridExtra)
library(igraph)
library(ggnetwork)
networks <- readRDS("networks.rds")
transitivity <- readRDS("transitivity.rds") |>
mutate(
Transitivity = as.numeric(Transitivity)
)
slr_data <- readRDS("slr_data.rds")
View(networks)
TEX
#TEX network
#pull Rangers data from RDS
tex_net <- ggnetwork(networks[["TEX"]])
ggplot(tex_net, aes(x, y, xend = xend, yend = yend)) +
geom_edges(color = "blue") +
geom_nodes(size = 3) +
geom_nodelabel(aes(label = name), size = 3) +
theme_blank() +
ggtitle("Texas Rangers Social Network (2015–2025)"))
#TEX network
#pull Rangers data from RDS
tex_net <- ggnetwork(networks[["TEX"]])
ggplot(tex_net, aes(x, y, xend = xend, yend = yend)) +
geom_edges(color = "blue") +
geom_nodes(size = 3) +
geom_nodelabel(aes(label = name), size = 3) +
theme_blank() +
ggtitle("Texas Rangers Social Network (2015–2025)")
#SDP network
#pull Padres data from RDS
tex_net <- ggnetwork(networks[["SDP"]])
#network building
ggplot(tex_net, aes(x, y, xend = xend, yend = yend)) +
geom_edges(color = "yellow") +
geom_nodes(size = 3) +
geom_nodelabel(aes(label = name), size = 3) +
theme_blank() +
ggtitle("San Diego Padres Social Network 2015–2025")
#network building
ggplot(tex_net, aes(x, y, xend = xend, yend = yend)) +
geom_edges(color = "yellow") +
geom_nodes(size = 3) +
geom_nodelabel(aes(label = name), size = 3) +
theme_blank() +
ggtitle("San Diego Padres Social Network 2015–2025")
```
#SDP network
#pull Padres data from RDS
tex_net <- ggnetwork(networks[["SDP"]])
#network building
ggplot(tex_net, aes(x, y, xend = xend, yend = yend)) +
geom_edges(color = "yellow") +
geom_nodes(size = 3) +
geom_nodelabel(aes(label = name), size = 3) +
theme_blank() +
ggtitle("San Diego Padres Social Network 2015–2025")
#transitivity score table
transitivity_scores |>
arrange(desc(Transitivity)) |>
kable(
caption = "Team Transitivity Scores (2015–2025)",
booktabs = TRUE
)
#transitivity score table
transitivity |>
arrange(desc(Transitivity)) |>
kable(
caption = "Team Transitivity Scores (2015–2025)",
booktabs = TRUE
)
#scatterplot to show relationship
ggplot(slr_data, aes(x = Transitivity, y = AvgWinPct, label = Team)) +
geom_point()  +
geom_text(nudge_y = 0.003, size = 3) +
theme_minimal() +
labs(
title = "Transitivity vs. Average Win Percentage (2015–2025)",
x = "Transitivity Score",
y = "Average Win % from the 10 Seasons"
)
runApp()
runApp()
#TEX network
#pull Rangers data from RDS
tex_net <- ggnetwork(networks[["TEX"]])
#build network
ggplot(tex_net, aes(x, y, xend = xend, yend = yend)) +
geom_edges(color = "blue") +
geom_nodes(size = 3) +
geom_nodelabel(aes(label = name), size = 3) +
theme_blank() +
ggtitle("Texas Rangers Social Network 2015–2025")
#TEX network
#pull Rangers data from RDS
tex_net <- ggnetwork(networks[["TEX"]])
#build network
ggplot(tex_net, aes(x, y, xend = xend, yend = yend)) +
geom_edges(color = "blue") +
geom_nodes(size = 3) +
geom_nodelabel(aes(label = name), size = 3) +
theme_blank() +
ggtitle("Texas Rangers Social Network 2015–2025")
```{r, fig.width = 5, fig.height = 5x}
```{r, fig.width = 5, fig.height = 5}
#TEX network
#pull Rangers data from RDS
tex_net <- ggnetwork(networks[["TEX"]])
#build network
ggplot(tex_net, aes(x, y, xend = xend, yend = yend)) +
geom_edges(color = "blue") +
geom_nodes(size = 3) +
geom_nodelabel(aes(label = name), size = 3) +
theme_blank() +
ggtitle("Texas Rangers Social Network 2015–2025")
#TEX network
#pull Rangers data from RDS
tex_net <- ggnetwork(networks[["TEX"]])
#build network
ggplot(tex_net, aes(x, y, xend = xend, yend = yend)) +
geom_edges(color = "blue") +
geom_nodes(size = 3) +
geom_nodelabel(aes(label = name), size = 3) +
theme_blank() +
ggtitle("Texas Rangers Social Network 2015–2025")
